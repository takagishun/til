# 10 æœˆ 21 æ—¥

## WebStorm

`Languages and Frameworks > Javascript > Prettier` ã§`On save`ã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã¦ã„ã‚‹ã¨ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜ã¨åŒæ™‚ã« prettier ã®ãƒ•ã‚©ãƒãƒƒã‚¿ãƒ¼ãŒå®Ÿè¡Œã•ã‚Œã‚‹ãŒã€ã‚ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§ã¯å®Ÿè¡Œã—ãŸããªã„å ´åˆãŒã‚ã‚‹ã€‚
`frontend/`é…ä¸‹ã‚’ package.json ã®ç®¡ç†ä¸‹ã§ prettier ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹å ´æ‰€ã ã£ãŸã¨ã™ã‚‹ã€‚é€šå¸¸ã€ã‚³ãƒãƒ³ãƒ‰ã§ prettier ã‚’å®Ÿè¡Œã™ã‚‹å ´åˆã¯ç®¡ç†ä¸‹å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã™ã‚‹ã ã‘ã§ã‚ã‚‹ã€‚ãŸã `Languages and Frameworks > Javascript > Prettier` ã§è¨­å®šã—ãŸ webstorm ã® prettier ã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã«é©ç”¨ã•ã‚Œã‚‹ã€‚
ãã†ã™ã‚‹ã¨ã€package.json çš„ã«ã¯ prettier ã®ç®¡ç†å¤–ãªã®ã ãŒã€äºˆæœŸã—ãªã„ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãŒèµ°ã£ã¦ã—ã¾ã†ã€‚
è§£æ±ºç­–ã¯ã€`Languages and Frameworks > Javascript > Prettier` ã§`Run for file`ã§æŒ‡å®šã—ã¦ã‚ã’ã‚Œã°ã§ãã‚‹ã€‚ãã†ã™ã‚‹ã¨ code formatter ã® prettier ã‚’å®Ÿè¡Œã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’çµã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚
ä¾‹ãˆã°`frontend/`é…ä¸‹ã§ã¯é©ç”¨ã—ãŸã„ãŒã€`backend`ã§ã¯é©ç”¨ã—ãŸããªã„æ™‚ãªã©ã¯ã€`Run for file`ã« `frontend/{**/*,*}.{js,ts,jsx,tsx}`ã‚’æŒ‡å®šã™ã‚Œã°è‰¯ã„ã€‚

# 10 æœˆ 20 æ—¥

## Javascript

æ–‡å­—æ•°åˆ¤å®šã™ã‚‹ã®ã«åŸºæœ¬çš„ã«ã¯ length ã§å•é¡Œãªã„ãŒã€çµµæ–‡å­—ã¨ã‹ã‚’è¨±å®¹ã™ã‚‹ã¨ length ã§ã¯ãƒ€ãƒ¡ãªã®ã‚’çŸ¥ã£ãŸã€‚
ãƒ©ã‚¤ãƒ–ãƒ©ãƒªä½¿ã†ã®ãŒè‰¯ã•ãã†ã ã‘ã©ã€ã©ã†ã‚„ã£ã¦åˆ¤å®šã™ã‚‹ã ã‚ã†

```javascript
"aaa".length;
// 3
"â˜ï¸".length;
// 2
"ğŸšµâ€â™‚ï¸".length;
// 5
```

# 10 æœˆ 19 æ—¥

## ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰

### ãƒ•ã‚¡ã‚¤ãƒ«ç¨®åˆ¥ã‚’åˆ¤åˆ¥ã™ã‚‹æ–¹æ³•

#### æ‹¡å¼µå­

ç¢ºèªã™ã‚‹æ™‚ã«æ‹¡å¼µå­ã‚’è¦‹ã‚Œã°å¤§ä½“äºˆæ¸¬ã§ãã‚‹ãŒä¿¡é ¼æ€§ãŒä½ã„ã€‚
ã¡ãªã¿ã« Web API ã® File ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã® type ã¯æ‹¡å¼µå­ã§åˆ¤åˆ¥ã—ã¦ã„ã‚‹ã€‚

> ãƒ•ã‚¡ã‚¤ãƒ«ã®æ‹¡å¼µå­ã«åŸºã¥ã„ã¦æ¨æ¸¬ã—ã¾ã™ã€‚ PNG ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’ .txt ã«æ”¹åã™ã‚‹ã¨ "text/plain" ã¨ãªã‚Šã€"image/png" ã¨ã¯ãªã‚Šã¾ã›ã‚“ã€‚

https://developer.mozilla.org/ja/docs/Web/API/File/type

ã¾ãŸ fetch API ã§ content-type ã‚’æ˜è¨˜ã—ãªã‹ã£ãŸå ´åˆã€è‡ªå‹•ã§ä»˜ä¸ã•ã‚Œã‚‹ãŒã€ã“ã“ã§ã‚‚æ‹¡å¼µå­ã§åˆ¤åˆ¥ã—ã¦ã„ã‚‹ã‚‰ã—ã„(ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯è¦‹ã¤ã‹ã‚‰ãªã„ãŒã€chrome dev tool ã§ç¢ºèªã§ããŸ)

#### ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼

> ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆè­˜åˆ¥å­ã¨ã—ã¦ã®ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ã¨ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ã®ç¨®é¡ã‚’è­˜åˆ¥ã™ã‚‹ã®ã«ä½¿ã‚ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«æœ¬æ–‡ä¸­ã®ï¼ˆå†…å®¹ä¸­ã®ï¼‰ç‰¹å®šã®ä½ç½®ã«ã‚ã‚‹ç‰¹å®šã®æ•°å€¤ã®ã“ã¨ã§ã‚ã‚‹ã€‚ãƒ•ã‚¡ã‚¤ãƒ«ã®ç¨®é¡ã‚’è­˜åˆ¥ã™ã‚‹æ–¹æ³•ã¨ã—ã¦ã¯ãƒ•ã‚¡ã‚¤ãƒ«ã®æ‹¡å¼µå­ã‚„å±æ€§å€¤ï¼ˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ï¼‰ã‚’ä½¿ã†å ´åˆã‚‚ã‚ã‚‹ãŒã€ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ã¨ã¯ãã‚Œã‚‰ã®ã“ã¨ã§ã¯ãªãã€ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ¬æ–‡ä¸­ã«è¡¨ã‚Œã‚‹ç‰¹å®šã®æ•°å€¤ã®ã“ã¨ã§ã‚ã‚‹ã€‚ã»ã¨ã‚“ã©ã®å ´åˆã€ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ã¯ãƒ•ã‚¡ã‚¤ãƒ«ã®å…ˆé ­ã«ä½ç½®ã—ã€æ•°ãƒã‚¤ãƒˆç¨‹åº¦ã§ã‚ã‚‹ã€‚

ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ (ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆè­˜åˆ¥å­) - ã‚¦ã‚£ã‚­ãƒšãƒ‡ã‚£ã‚¢ï¼ˆWikipediaï¼‰

npm ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ã¯ file-type ãªã©ãŒã€ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ã§ã®ãƒ•ã‚¡ã‚¤ãƒ«ç¨®åˆ¥åˆ¤å®šã‚’æ¡ç”¨ã—ã¦ã„ã‚‹
https://www.npmjs.com/package/file-type

```javascript
const fs = require("fs");
const FileType = require("file-type");

const checkFileType = async () => {
  const stream = fs.createReadStream("./test.png");
  const fileMeta = await FileType.fromStream(stream);
  console.log(fileMeta);
};

checkFileType();
```

```
$ node test.js
{ ext: 'png', mime: 'image/png' }
```

æ‹¡å¼µå­ã‚’ txt ã«å¤‰ãˆã¦ã¿ã¦ã‚‚ã€ã¡ã‚ƒã‚“ã¨ png ã¨ã—ã¦åˆ¤å®šã•ã‚Œã†

```javascript
const fs = require("fs");
const FileType = require("file-type");

const checkFileType = async () => {
  const stream = fs.createReadStream("./test.txt");
  const fileMeta = await FileType.fromStream(stream);
  console.log(fileMeta);
};

checkFileType();
```

```
$ node test.js
{ ext: 'png', mime: 'image/png' }
```

Linux ã® file ã‚³ãƒãƒ³ãƒ‰ã§ã‚‚ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ã®åˆ¤å®šãŒè¡Œã‚ã‚Œã‚‹

```
$ file ./test.txt
./test.txt: PNG image data, 500 x 360, 8-bit/color RGBA, non-interlaced
```

# 10 æœˆ 18 æ—¥

## React

https://ja.reactjs.org/docs/code-splitting.html  
React å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ã€Œã‚³ãƒ¼ãƒ‰åˆ†å‰²ã€ã®ãƒšãƒ¼ã‚¸ã‚’ä»Šã¾ã§èª­ã‚“ã ã“ã¨ãªã‹ã£ãŸã®ã§ã€èª­ã‚“ã§ã¿ã‚‹ã€‚

- ã‚¢ãƒ—ãƒªãŒå¤§ãããªã‚‹ã«ã¤ã‚Œãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚ºã‚‚å¤§ãããªã‚Šã€åˆæœŸãƒ­ãƒ¼ãƒ‰æ™‚ã®èª­ã¿è¾¼ã¿æ™‚é–“ãŒã‹ã‹ã£ã¦ã—ã¾ã†ã€‚
- ç‰¹ã«ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ†ã‚£ãƒ¼ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®å°å…¥æ™‚ã«ã¯ã€ãã®ã‚µã‚¤ã‚ºã«æ³¨æ„ã™ã‚‹ã€‚(ãã†ã„ãˆã°å…ˆè¼©ãŒã€ã‚µã‚¤ã‚ºå¤§ãã„ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’å¿…è¦ãªç®‡æ‰€ã ã‘æ–°ã—ã„ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«åˆ‡ã‚Šå‡ºã—ã¦ä½¿ã£ã¦ãŸã®ã‚’æ€ã„å‡ºã—ãŸ)
- å¤§ããªãƒãƒ³ãƒ‰ãƒ«ã‚’ç”Ÿæˆã—ãªã„ã‚ˆã†ã«ã€ã‚³ãƒ¼ãƒ‰ã®åˆ†å‰²ã™ã¹ã
- ã‚³ãƒ¼ãƒ‰ã®åˆ†å‰²ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå¿…è¦ã¨ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã ã‘ã‚’åˆæœŸãƒ­ãƒ¼ãƒ‰ã§ãã€ä»–ã®ã‚³ãƒ¼ãƒ‰ã¯ã€Œé…å»¶èª­ã¿è¾¼ã¿ã€ã§ãã‚‹
- ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å˜ä½ã§ã‚³ãƒ¼ãƒ‰åˆ†å‰²ã™ã‚‹ã®ãŒåŠ¹æœçš„

å®Ÿéš›ã‚³ãƒ¼ãƒ‰æ›¸ã„ã¦å‹•ã‹ã—ãŸã„

https://nextjs.org/docs/advanced-features/dynamic-import
next ã§ã©ã†ãªã£ã¦ã„ã‚‹ã‹ã‚‚èª¿ã¹ãŸã„

### ã‚³ãƒ¼ãƒ‰åˆ†å‰²æ–¹æ³•

1. import() æ§‹æ–‡ã‚’ä½¿ã†
2. ã•ã‚‰ã« React.lazy é–¢æ•°ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€å‹•çš„ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚’é€šå¸¸ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ã—ã¦ãƒ¬ãƒ³ãƒ€ãƒ¼ã™ã‚‹ã“ã¨ãŒã§ãã‚‹

# 10 æœˆ 17 æ—¥

## ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰

https://xhr.spec.whatwg.org/#the-upload-attribute
https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/upload
XMLHttpRequest ã® upload ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¯ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã®é€²æ—ã‚’ç›£è¦–ã§ãã‚‹ XMLHttpRequestUpload ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”ã™
XMLHttpRequestEventTarget ã§ã‚‚ã‚ã‚‹ã®ã§ã€ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’ã‚¢ã‚¿ãƒƒãƒã™ã‚‹ã“ã¨ãŒã§ãã‚‹

react ã®ã‚³ãƒ¼ãƒ‰ä¾‹

```tsx
const FileUpload = () => {
  const [file, setFile] = useState<File>();
  const [uploadProgress, setUploadProgress] = useState(0);
  const [uploadStart, setUploadStart] = useState(false);
  const handleSubmit = (e: React.FormEvent) => {
    e.preventDefault();
    const xhr = new XMLHttpRequest();
    // é€²æ—çŠ¶æ³ã‚’ã‚’è¡¨ã™
    xhr.upload.addEventListener("progress", (event) => {
      event.lengthComputable
        ? setUploadProgress((event.loaded / event.total) * 100)
        : null;
    });
    // ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãŒå§‹ã¾ã‚Šã¾ã—ãŸã€‚
    xhr.upload.addEventListener("loadstart", () => {
      setUploadStart(true);
    });
    xhr.open("POST", "/");
    xhr.setRequestHeader("Content-Type", "application/octet-stream");
    xhr.send(file);
  };

  const progressValue = parseInt(String(uploadProgress));

  return (
    <form method="POST" onSubmit={handleSubmit}>
      <input
        type="file"
        onChange={(e) => e.target.files && setFile(e.target.files[0])}
      />
      {uploadStart && (
        <progress max="100" value={progressValue}>
          {progressValue}
        </progress>
      )}
      <br />
      <input type="submit" />
    </form>
  );
};
```

# 10 æœˆ 16 æ—¥

## React

èª¿ã¹ãŸã®ã§ãƒ¡ãƒ¢ã€‚
é•·ã„ form ã®ä¸Šéƒ¨ã«ã‚¨ãƒ©ãƒ¼ãƒãƒ¼ã‚’è¡¨ç¤ºã™ã‚‹å ´åˆã€submit ãƒœã‚¿ãƒ³ã‹ã‚‰ã‚¨ãƒ©ãƒ¼ãƒãƒ¼ãŒè¦‹ãˆã‚‹ä½ç½®ã¾ã§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã—ãŸã„.
react ã® ref & useEffect ã¨ scroll-into-view ã¨ã„ã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ãˆã°ã§ãã‚‹
https://www.npmjs.com/package/scroll-into-view

Web API ã® Element.scrollIntoView()ãŒã‚ã‚‹ã®ã§ã‚µãƒãƒ¼ãƒˆãƒ–ãƒ©ã‚¦ã‚¶æ¬¡ç¬¬ã§ä½¿ãˆã‚‹(safari ã¨ IE ãŒå¯¾å¿œã—ã¦ãªã„)
https://developer.mozilla.org/ja/docs/Web/API/Element/scrollIntoView

```
export const Errors: FC<{ errors: string[] }> = ({ errors }) => {
  const element = useRef<HTMLDivElement>(null);
  useEffect(() => {
      // Web APIã‚’ä½¿ã†å ´åˆ
      // element.current && element.current.scrollIntoView({ behavior: "smooth" });
      element.current && scrollIntoView(element.current, { time: 300 });
  }, [errors]);
  return (
    <div ref={element}>
      {errors.map((err, index) => (
        ...ã‚¨ãƒ©ãƒ¼è¡¨ç¤º
        )
      }
    </>
   )
 }
```

```
import { FC } from "react";
import { Errors } from "../components/errors";

const Form: FC<{ errors: string[] }> = ({ errors }) => {
  return (
    <>
      {errors && <Errors errors={errors} />}
      <form>...é•·ã„form</form>
    </>
  );
};

export default Form;
```

# 10 æœˆ 15 æ—¥

## React ã® Form ãƒ©ã‚¤ãƒ–ãƒ©ãƒª

é›‘ã«ãƒ¡ãƒ¢ã€‚Form ãƒ©ã‚¤ãƒ–ãƒ©ãƒªè‡ªä½“ã‚ã¾ã‚Šä½¿ã£ãŸã“ã¨ãªãã¦è©¦ã—ãŸããªã£ãŸ
å¤‰é·ã‚’ã¾ã¨ã‚ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚‹ã€‚

- çŠ¶æ…‹ã®ç®¡ç†æ–¹æ³•: ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ãƒ†ãƒ¼ãƒˆ(redux form) => ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒ†ãƒ¼ãƒˆ(formik) => ref(react-hook-form)
- controlled => Uncontrolled

### redux form

- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã«èª²é¡Œã‚ã‚Š
- å…¥åŠ›å€¤ã‚’å¤‰ãˆã‚‹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒç™ºç«
- ä¸Šã®æ–¹ã§ connect ã—ã¦ã‚‹ã®ã§ redux ãƒ„ãƒªãƒ¼å…¨ä½“ãŒå†è¨ˆç®—ã•ã‚Œã‚‹
- v6~?ã‹ã‚‰ connect ãŒæœ«ç«¯ã«å®Ÿè£…ã•ã‚ŒãŸãŒã€connect ã®å‡¦ç†è‡ªä½“ãŒé‡ã„
- controlled

### formik

- Form ã®ã‚ˆã†ãªä¸€æ™‚çš„ãª state ã«å¯¾ã—ã¦ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ä½¿ã†ã®ã¯ã‚ã¾ã‚Šè‰¯ããªã„ => local state ã‚’ä½¿ã†
- ã§ã‚‚ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒæ”¹å–„ã•ã‚Œã¦ãªã„
- (ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹é¢ã§)åŸå‰‡: useState ã¯æœ«ç«¯ã§ã€memo åŒ–ã¯ä¸Šã§ => formik ã¯é€†ã®è¨­è¨ˆã«ãªã£ã¦ã„ã‚‹
- controlled

### react-hook-form

- ref ã‚’æ‰±ã†å¿…è¦ã‚ã‚Š
- å…¥åŠ›å€¤ã‚’å¤‰æ›´ã™ã‚‹ã®ã¿ã ã£ãŸã‚‰ ref ã‚’ä½¿ã†ã®ã§å†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã¯ä¸€åˆ‡ç™ºç”Ÿã—ãªã„
- ãŸã  errors ã¯ formState ã«å…¥ã£ã¦ã„ã‚‹ã€‚ãƒã‚±ãƒ„ãƒªãƒ¬ãƒ¼ã™ã‚‹ã®ã§ãã“ã§ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã¡ã‚ƒã†
- ãªã®ã§ onChange ãƒãƒªãƒ‡ã—ãªã„ã§ onBlur ã§ãƒãƒªãƒ‡ã‚„ã£ãŸæ–¹ãŒè‰¯ã„
- useController API ã¯ä¸‹ã§ä½¿ã†ã¹ãã€‚input ã®éš£ã¨ã‹
- uncontrolled

# 10 æœˆ 14 æ—¥

## File Upload

https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/upload  
XMLHttpRequest ã® upload ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¯ã€ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã®é€²æ—ã‚’ç›£è¦–ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚
File ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã®ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã‚’è¡¨ç¤ºã™ã‚‹æ™‚ãªã©ã«ä½¿ãˆã‚‹ã£ã½ã„ã®ã§æ–¹æ³•ã‚’èª¿ã¹ã¦ã„ããŸã„ã€‚

# 10 æœˆ 13 æ—¥

## reselect

https://github.com/reduxjs/reselect#createselectorinputselectors--inputselectors-resultfunc

> createSelector determines if the value returned by an input-selector has changed between calls using reference equality (===). Inputs to selectors created with createSelector should be immutable.

ç¬¬ä¸€å¼•æ•°ã«ä¸ãˆã‚‰ã‚ŒãŸã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼ãŒè¿”ã™å€¤ã‚’===ã§æ¯”è¼ƒã—ã¦ã€åŒã˜ã§ã‚ã‚Œã°å†è¨ˆç®—ã•ã‚Œãšãƒ¡ãƒ¢åŒ–ã—ãŸå€¤ã‚’è¿”ã™ã€‚
ãªã®ã§ã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼ãŒè¿”ã™å€¤ãŒ reference å‹ã®å ´åˆã¯ã€åŒã˜å€¤ã§ã‚ã£ã¦ã‚‚ reference ç•°ãªã‚Œã°å†è¨ˆç®—ã•ã‚Œã‚‹ã€‚

â†“ ã®ä¾‹ã ã¨ state ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å‚ç…§ãŒé•ã†ã®ã§\_selector1,\_selector2 ã©ã¡ã‚‰ã¨ã‚‚å†è¨ˆç®—ã•ã‚Œæ–°ã—ã„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”ã™ã€‚
ãã®ãŸã‚\_selector1,\_selector2 ã‚’å¼•æ•°ã«ã—ã¦ã„ã‚‹ selector ã‚‚ã€å†è¨ˆç®—ã•ã‚Œã‚‹

```js
const _selector1 = createSelector(
  (state) => state,
  () => ({})
);
const _selector2 = createSelector(
  (state) => state,
  () => ({})
);
const selector = createSelector([_selector1, _selector2], () =>
  console.log("execute!")
);

selector({});
selector({});
```

```
$ node index.js
execute!
execute!
```

react ã® memoã€useEffect,useMemo ã®ç¬¬ï¼’å¼•æ•°ã¨ã‹ã§ã‚‚åŒã˜ãªã®ã§ã€redux, react ç•Œéšˆã®ã“ã“ã‚‰è¾ºã®æ¯”è¼ƒãƒ­ã‚¸ãƒƒã‚¯ã¯å…±é€šãªã‚“ã ã‚ã†ã€‚

https://github.com/reduxjs/reselect#createselectorcreatormemoize-memoizeoptions
createSelectorCreator API ã‚’ä½¿ãˆã°ã€ç‹¬è‡ªã®ç­‰ä¾¡ãƒã‚§ãƒƒã‚¯æ©Ÿæ§‹ã‚’æŒã£ãŸ createSelector ã‚’ä½œæˆã§ãã‚‹

```js
const { createSelectorCreator, defaultMemoize } = require("reselect");
const { isEqual } = require("lodash");

const createSelector = createSelectorCreator(defaultMemoize, isEqual);

const selector = createSelector(
  (state) => state,
  () => console.log("è¨ˆç®—ã•ã‚ŒãŸï¼")
);

selector({});
selector({});
```

```
$ node index.js
è¨ˆç®—ã•ã‚ŒãŸï¼
```

selector ã®å†è¨ˆç®—ã‚ˆã‚Šã€ç­‰ä¾¡ãƒã‚§ãƒƒã‚¯ãªã©ã®ãƒ¡ãƒ¢åŒ–å‡¦ç†ã®æ–¹ãŒé‡ããªã£ã¦ã—ã¾ã†ã¨æœ¬æœ«è»¢å€’ãªã®ã§æ°—ã‚’ã¤ã‘ã‚‹ã€‚

# 10 æœˆ 12 æ—¥

## Prisma

https://www.prisma.io/docs/guides/database/seed-database
Prisma ã® seed æ©Ÿèƒ½ã‚’è§¦ã£ã¦ã¿ãŸã€‚  
prisma/seed.ts ã«å®šç¾©ã—ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®åˆæœŸãƒ‡ãƒ¼ã‚¿ã‚’æµã—è¾¼ã‚€ã“ã¨ãŒã§ãã‚‹ã€‚

package.json ã« â†“ ã‚’è¿½è¨˜

```
"prisma": {
  "seed": "ts-node prisma/seed.ts"
},
```

Next.js ã‚’ä½¿ã£ã¦ã‚‹æ™‚ã¯ â†“

```
"prisma": {
   "seed": "ts-node --compiler-options {\"module\":\"CommonJS\"} prisma/seed.ts"
},
```

prisma/seed.ts

```typescript
import { PrismaClient } from "@prisma/client";
const prisma = new PrismaClient();

async function main() {
  const alice = await prisma.user.upsert({
    where: { email: "alice@prisma.io" },
    update: {},
    create: {
      email: "alice@prisma.io",
      name: "Alice",
    },
  });
}

main()
  .catch((e) => {
    console.error(e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  });
```

seed ã‚’æµã—è¾¼ã¿ã‚¿ã‚¤ãƒŸãƒ³ã‚°

- `prisma migrate reset` or `prisma migrate dev` ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ãŸæ™‚ã€‚ (seed ã®ã‚¹ã‚­ãƒƒãƒ—ã¯--skip-seed)
- æ‰‹å‹•ã§ `prisma db seed` ã‚’å®Ÿè¡Œã—ãŸæ™‚

## reselect

https://github.com/reduxjs/reselect  
ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”ã™ selector ã‚’åˆ¥ã® selector ã«æ¸¡ã—ã¦ã‚‚ãƒ¡ãƒ¢åŒ–ã§ãã‚‹ã®ã‹æ¤œè¨¼ã€‚  
=> çµè«–ã€ã§ãã‚‹ã€‚

index.js

```js
const reselect = require("reselect");

const a = (state) => state.a;
const b = (state) => state.b;

const selector = reselect.createSelector(a, b, (a, b) => {
  console.log("selector");
  return { ...a, ...b };
});

const selector2 = reselect.createSelector(selector, a, (selector, a) => {
  console.log("selector2");
  return { ...selector, ...a };
});

const selector3 = reselect.createSelector(
  selector,
  selector2,
  (selector, selector2) => {
    console.log("selector3");
    return { ...selector, ...selector2 };
  }
);

let state = {
  a: {},
  b: {},
  c: {},
};

selector3(state);

selector3({ ...state, c: {} });
```

2 å›ç›®ã® selector3 å‘¼å‡ºã§ã¯ã€å„ selector ã®é–¢æ•°ã¯å®Ÿè¡Œã•ã‚Œã¦ã„ãªã„ã€‚

```bash
$ node index.js
selector
selector2
selector3
```

# 10 æœˆ 10 æ—¥

## Prisma

## ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒªãƒ¼ãƒ‡ã‚£ãƒ³ã‚°

https://www.prisma.io/docs/concepts

### What is Prisma?

Prisma ã¨ã¯ Object-relational mapping(ORM)ã€‚  
3 ã¤ã«ã•ã‚Œã‚‹æ§‹æˆã•ã‚Œã‚‹ã€‚

- Prisma Client: Node.js ã¨ TypeScript ç”¨ã®è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸã‚¿ã‚¤ãƒ—ã‚»ãƒ¼ãƒ•ãªã‚¯ã‚¨ãƒªãƒ“ãƒ«ãƒ€ãƒ¼
- Prisma Migrate: Migration system
- Prisma Studio: GUI ã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æ“ä½œã§ãã‚‹

Prisma Client ã¯ã€Node.js ã¨ Typescript ã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ä½¿ç”¨ã™ã‚‹(ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚„ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚‚å«ã‚€)ã€‚  
REST APIã€GraphQL APIã€gRPC API ã©ã‚Œã§ã‚‚å¯¾å¿œå¯èƒ½ã€‚

### How does Prisma work?

Prisma ã‚¹ã‚­ãƒ¼ãƒãƒ•ã‚¡ã‚¤ãƒ«ã§ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¢ãƒ‡ãƒ«ã‚’å®šç¾©ã—ãŸã‚Šã€DB ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ã‚„ã‚¸ã‚§ãƒãƒ¬ã‚¿ãƒ¼ã‚’å®šç¾©ã™ã‚‹ã€‚  
Prisma ã‚¹ã‚­ãƒ¼ãƒãƒ•ã‚¡ã‚¤ãƒ«ã¯ä»¥ä¸‹ã® 3 ã¤ã§æ§‹æˆã•ã‚Œã‚‹

- Data source: DB æ¥ç¶šã‚’æŒ‡å®š
- Generator: Prisma ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ç”Ÿæˆ
- Data model: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¢ãƒ‡ãƒ«ã‚’å®šç¾©

#### Prisma ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«

ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ã¯ãƒ¢ãƒ‡ãƒ«ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã‚ã‚Šã€2 ã¤ã®ä¸»è¦ãªæ©Ÿèƒ½ãŒã‚ã‚‹ã€‚

- ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒŠãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã¾ãŸã¯ MongoDB ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¡¨ã™
- Prisma ClientAPI ã§ã‚¯ã‚¨ãƒªã®åŸºç›¤ã‚’æä¾›ã™ã‚‹

Prisma ã‚¹ã‚­ãƒ¼ãƒã«ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ã‚’å–å¾—ã™ã‚‹ãŸã‚ã® 2 ã¤ã®æ–¹æ³•

- Prisma Migrate ã‚’ä½¿ç”¨ã—ã¦ã€æ‰‹å‹•ã§ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ã‚’è¨˜è¿°ã—ã¦ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ãƒãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ã®å†…çœ
